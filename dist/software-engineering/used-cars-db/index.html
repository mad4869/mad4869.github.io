<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="MAkbarD's blog"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.9.2"><meta name="og:image" content="/img/blog/logo.svg"><title>Used Cars Database | MAD4869</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/index.CtxG5iuT.css"><script type="module" src="/_astro/hoisted.DZL4CV8D.js"></script></head> <body> <header class="w-screen px-px"> <nav class="flex items-center justify-between w-full px-16 py-4 border shadow-lg text-fuchsia-800 border-fuchsia-800 rounded-b-3xl shadow-fuchsia-200/20"> <a href="/" class="text-3xl font-bold" title="Home"> <img src="/_astro/logo.DoQbXR2Z_Z1GL1ve.svg" alt="Logo Blog" loading="lazy" class="drop-shadow-[0_0_10px_rgba(232,121,249,0.5)]" width="50" height="16" decoding="async"> </a> <ul class="flex items-center justify-center gap-8"> <li title="Self-introduction"> <a href="/about" class="pb-1 transition-colors border-fuchsia-400 hover:text-fuchsia-400">
About
</a> </li> <li title="Software engineering portfolio"> <a href="/software-engineering" class="pb-1 transition-colors border-fuchsia-400 hover:text-fuchsia-400">
Software Engineering
</a> </li> <li title="Writing portfolio"> <a href="/writing" class="pb-1 transition-colors border-fuchsia-400 hover:text-fuchsia-400">
Writing
</a> </li> <li title="Some random rambling about anything"> <a href="/notes" class="pb-1 transition-colors border-fuchsia-400 hover:text-fuchsia-400">
Notes
</a> </li> </ul> <ul class="flex items-center justify-center gap-4"> <li class="transition-all hover:text-fuchsia-400 hover:scale-110" title="Go to Twitter"> <a href="https://twitter.com/MAD4869" target="_blank"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> </li> <li class="transition-all hover:text-fuchsia-400 hover:scale-110" title="Go to Github"> <a href="https://github.com/mad4869" target="_blank"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 480 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> </li> <li class="transition-all hover:text-fuchsia-400 hover:scale-110" title="Go to Wattpad"> <a href="https://www.wattpad.com/user/aconitin_4869" target="_blank"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.034 3.09c-1.695.113-3.9 2.027-6.9 6.947.245-2.758.345-4.716-.857-5.743-.823-.702-2.764-.974-3.926.536C.18 6.349-.09 9.312.024 12.432c.238 6.518 2.544 8.487 4.59 8.487h.001c3.623 0 4.13-4.439 6.604-8.4-.09 1.416-.008 2.668.266 3.532 1.078 3.398 4.784 3.663 6.467.21 2.374-4.87 3.058-6.016 5.453-9.521 1.58-2.314-.252-3.812-2.374-2.735-1.09.554-2.86 1.935-5.065 4.867.387-2.23.28-5.996-2.932-5.782z"></path></svg> </a> </li> <li class="transition-transform hover:scale-110" title="Go to KaryaKarsa"> <a href="https://karyakarsa.com/aconitin/" target="_blank"> <img src="/_astro/logo-kk.qwGrKF09_Z1sqeHs.svg" alt="Logo KaryaKarsa" loading="lazy" width="10" height="10" decoding="async"> </a> </li> <li class="transition-transform hover:scale-110" title="Go to Kwikku"> <a href="https://www.kwikku.com/mad4869" target="_blank"> <img src="/_astro/logo-kwik.CgTZu3Cm_Z9Bwy4.svg" alt="Logo Kwikku" loading="lazy" width="15" height="15" decoding="async"> </a> </li> </ul> </nav> </header>  <main class="min-h-[calc(100dvh-8rem)] text-fuchsia-400 py-8 px-16 space-y-4"> <section class="flex items-center justify-between"> <div> <h1 class="text-3xl font-bold">Used Cars Database</h1> <h6 class="">A database design project for used cars e-commerce.</h6> </div> <div> <p class="text-xs text-fuchsia-400/50">SQL</p><p class="text-xs text-fuchsia-400/50">Data Engineering</p> </div> </section> <img src="/_astro/overtime-system.lGE-G_8n_Z1BYCEV.webp" alt="Hero Image of Used Cars Database" class="max-w-full mx-auto transition-shadow shadow-lg rounded-xl shadow-fuchsia-200/20 hover:shadow-fuchsia-200/40" loading="lazy" width="1918" height="954" decoding="async"> <article class="prose prose-img:rounded-xl text-fuchsia-200 prose-headings:text-fuchsia-400 dark:prose-invert prose-a:text-fuchsia-200 hover:prose-a:text-fuchsia-800"> <h2 id="background">Background</h2>
<p>On this used car website, users who register as sellers can create advertisements offering used cars for sale. On the other hand, users who register as buyers can search for products based on several categories.</p>
<h2 id="feature--constraints">Feature &#x26; Constraints</h2>
<ol>
<li>Each seller can list one or more used car products for sale.</li>
<li>Before selling a car, the seller must complete their personal data, including name, contact information, and domicile location.</li>
<li>Sellers offer their products through advertisements that will be displayed on the website.</li>
<li>The ads on the website include titles, detailed product information, and contact details of the sellers.</li>
<li>Some of the information that must be included in the ad are as follows:
<ul>
<li>Brand</li>
<li>Model</li>
<li>Body type</li>
<li>Car type</li>
<li>Production year</li>
<li>Additional descriptions such as color or mileage may be added as needed.</li>
</ul>
</li>
<li>Each buyer can search for the offered cars based on the sellerâ€™s location, brand, and car body type.</li>
<li>If a potential buyer is interested, they can submit a bid (if the seller allows the bidding feature).</li>
</ol>
<h2 id="designing-the-database">Designing the Database</h2>
<h3 id="1-mission-statement">1. Mission Statement</h3>
<!-- ![Mission statement](docs/design-process/mission_statement.jpg) -->
<h3 id="2-creating-table-structures">2. Creating Table Structures</h3>
<ul>
<li>Determine the objects</li>
</ul>
<!-- ![Table structures](docs/design-process/creating_table_structures.jpg) -->
<ul>
<li>Creating Field Name and Data Type</li>
</ul>
<!-- ![Field name and data type](docs/design-process/creating_field_name_data_type.jpg) -->
<ul>
<li>Determine Candidate Keys</li>
</ul>
<!-- ![Candidate keys](docs/design-process/determine_candidate_keys.jpg) -->
<ul>
<li>Determine Primary Keys</li>
</ul>
<!-- ![Primary keys](docs/design-process/determine_primary_keys.jpg) -->
<h3 id="3-determine-table-relationships">3. Determine Table Relationships</h3>
<!-- ![Table relationship](docs/design-process/determine_table_relationships.jpg) -->
<h3 id="4-determine-business-rule">4. Determine Business Rule</h3>
<!-- ![Business rule](docs/design-process/determine_business_rule.jpg) -->
<h3 id="5-entity-relationship-diagram">5. Entity Relationship Diagram</h3>
<!-- ![Entity Relationship Diagram](docs/design-process/ERD_design.jpg) -->
<h2 id="implementing-the-design">Implementing the Design</h2>
<p>Tables are created in the PostgreSQL database using the following Data Definition Language (DDL) syntax:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">    -- TABLE 1 - seller</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> seller</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        seller_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        email </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">UNIQUE</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        phone_number </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">UNIQUE</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        created_at </span><span style="color:#F97583">TIMESTAMP</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 2 - buyer</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> buyer</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        buyer_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        email </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">UNIQUE</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        phone_number </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">UNIQUE</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        created_at </span><span style="color:#F97583">TIMESTAMP</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 3 - city</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> city</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        city_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        location</span><span style="color:#F97583"> POINT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 4 - seller_address</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> seller_address</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        seller_address_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        seller_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> seller(seller_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        city_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> city(city_id) </span><span style="color:#F97583">ON DELETE</span><span style="color:#E1E4E8"> RESTRICT,</span></span>
<span class="line"><span style="color:#F97583">        address</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        zip_code </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 5 - buyer_address</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> buyer_address</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        buyer_address_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        buyer_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> buyer(buyer_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        city_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> city(city_id) </span><span style="color:#F97583">ON DELETE</span><span style="color:#E1E4E8"> RESTRICT,</span></span>
<span class="line"><span style="color:#F97583">        address</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        zip_code </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 6 - products</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> products</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        product_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        brand </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        model </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        type</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        year</span><span style="color:#F97583"> INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        color </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">        distance </span><span style="color:#F97583">INT</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 7 - ads</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> ads</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        ad_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        title </span><span style="color:#F97583">VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        product_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> products(product_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        seller_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> seller(seller_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        availability</span><span style="color:#E1E4E8"> BOOL </span><span style="color:#F97583">NOT NULL</span><span style="color:#F97583"> DEFAULT</span><span style="color:#E1E4E8"> true,</span></span>
<span class="line"><span style="color:#E1E4E8">        bids_allowed BOOL </span><span style="color:#F97583">NOT NULL</span><span style="color:#F97583"> DEFAULT</span><span style="color:#E1E4E8"> true,</span></span>
<span class="line"><span style="color:#E1E4E8">        price </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#F97583"> CHECK</span><span style="color:#E1E4E8">(price </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">        created_at </span><span style="color:#F97583">TIMESTAMP</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- TABLE 8 - bids</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> bids</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        bid_id </span><span style="color:#F97583">SERIAL</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        ad_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> seller(seller_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        buyer_id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#F97583">            REFERENCES</span><span style="color:#E1E4E8"> buyer(buyer_id) </span><span style="color:#F97583">ON DELETE CASCADE</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        amount </span><span style="color:#F97583">INT</span><span style="color:#F97583"> NOT NULL</span><span style="color:#F97583"> CHECK</span><span style="color:#E1E4E8">(amount </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#F97583">        status</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">CHECK</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">status</span><span style="color:#F97583"> IN</span><span style="color:#E1E4E8"> (</span><span style="color:#9ECBFF">'Sent'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Cancelled'</span><span style="color:#E1E4E8">)),</span></span>
<span class="line"><span style="color:#E1E4E8">        created_at </span><span style="color:#F97583">TIMESTAMP</span><span style="color:#F97583"> NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">    );</span></span>
<span class="line"></span></code></pre>
<h2 id="populating-the-database">Populating the Database</h2>
<p>This database utilizes a dummy dataset to populate the data in each table. The dummy dataset is obtained from Excel files or generated using the <code>Faker</code> library. All the dummy data is then converted to a CSV file and imported into the PostgreSQL database using the import tool pgAdmin 4.</p>
<h3 id="read_excel">read_excel</h3>
<p>The <code>read_excel</code> module functions to retrieve data from an Excel file with the help of the <code>openpyxl</code> library and then converts it into a list of dictionaries, which can be further processed.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> openpyxl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> read_excel</span><span style="color:#E1E4E8">(file_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, worksheet_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    workbook </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> openpyxl.load_workbook(file_name)</span></span>
<span class="line"><span style="color:#E1E4E8">    worksheet </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> workbook[worksheet_name]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">    headers </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> item </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, worksheet.max_column </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        headers.append(worksheet.cell(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">item).value)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> worksheet.iter_rows(</span><span style="color:#FFAB70">min_row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">values_only</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        row_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> item </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(headers)):</span></span>
<span class="line"><span style="color:#E1E4E8">            key </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> headers[item]</span></span>
<span class="line"><span style="color:#E1E4E8">            value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> row[item]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            row_data[key] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        data.append(row_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> data</span></span>
<span class="line"></span></code></pre>
<h3 id="show_data">show_data</h3>
<p>The <code>show_data</code> module functions to display generated data tables. The views are created with the help of the <code>tabulate</code> library.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> tabulate </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> tabulate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> show_data</span><span style="color:#E1E4E8">(table: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    tab </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabulate(</span><span style="color:#FFAB70">tabular_data</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">table,</span></span>
<span class="line"><span style="color:#FFAB70">                    headers</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">table.keys(),</span></span>
<span class="line"><span style="color:#FFAB70">                    tablefmt</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"psql"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">                    numalign</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"center"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(tab)</span></span>
<span class="line"></span></code></pre>
<h3 id="get_tablespy">get_tables.py</h3>
<p>The <code>get_tables</code> module reads Excel file data using the <code>read_excel</code> module and then returns a dictionary which can be displayed using the <code>show_data</code> module. The available Excel files are:</p>
<ul>
<li>city</li>
<li>car_product</li>
</ul>
<p>The two datasets will be processed by the <code>get_city_table()</code> and <code>get_product_table()</code> functions and then return the <code>city</code> and <code>product</code> dictionaries. Specifically for <code>product</code>, a new column is also added which is not yet available in the Excel file and then the data is generated with <code>Faker</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> read_excel </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> read_excel</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> show_data </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> show_data</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> faker </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Faker</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">FAKER</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> Faker(</span><span style="color:#9ECBFF">'id_ID'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> get_city_table</span><span style="color:#E1E4E8">(file_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, worksheet_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    city_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">    name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">    location </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> read_excel(file_name, worksheet_name)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    city </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    city[</span><span style="color:#9ECBFF">"city_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">(data[i][</span><span style="color:#9ECBFF">"kota_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    city[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [data[i][</span><span style="color:#9ECBFF">"nama_kota"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    city[</span><span style="color:#9ECBFF">"location"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">data[i][</span><span style="color:#9ECBFF">"longitude"</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">, </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">data[i][</span><span style="color:#9ECBFF">"latitude"</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">'</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(city)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> city</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> get_product_table</span><span style="color:#E1E4E8">(file_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, worksheet_name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> read_excel(file_name, worksheet_name)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    product </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"product_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">(data[i][</span><span style="color:#9ECBFF">'product_id'</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"brand"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [data[i][</span><span style="color:#9ECBFF">'brand'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"model"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [data[i][</span><span style="color:#9ECBFF">'model'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"type"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [data[i][</span><span style="color:#9ECBFF">'body_type'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"year"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">(data[i][</span><span style="color:#9ECBFF">'year'</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"color"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.color_name() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"><span style="color:#E1E4E8">    product[</span><span style="color:#9ECBFF">"distance"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.random_int(</span><span style="color:#79B8FF">20_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">100_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5_000</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(data))]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(product)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> product</span></span>
<span class="line"></span></code></pre>
<h3 id="create_tablespy">create_tables.py</h3>
<p>The <code>create_tables</code> module contains functions that return dictionary tables whose contents are generated using the <code>Faker</code>, <code>datetime</code>, (for date data), and <code>random</code> libraries.</p>
<p>The tables created inside <code>create_tables</code> are:</p>
<ul>
<li>seller</li>
<li>buyers</li>
<li>seller_address</li>
<li>buyer_address</li>
<li>ads</li>
<li>bids</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> faker </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Faker</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> datetime</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> show_data </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> show_data</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> random</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">FAKER</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> Faker(</span><span style="color:#9ECBFF">'id_ID'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_seller_table</span><span style="color:#E1E4E8">(n_seller: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    seller </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    seller[</span><span style="color:#9ECBFF">"seller_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{FAKER</span><span style="color:#E1E4E8">.first_name()</span><span style="color:#79B8FF">}</span><span style="color:#79B8FF"> {FAKER</span><span style="color:#E1E4E8">.last_name()</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller[</span><span style="color:#9ECBFF">"email"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name.lower().replace(</span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">@</span><span style="color:#79B8FF">{FAKER</span><span style="color:#E1E4E8">.free_email_domain()</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> seller[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">]]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller[</span><span style="color:#9ECBFF">"phone_number"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.phone_number() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller[</span><span style="color:#9ECBFF">"created_at"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.date_time_between( </span><span style="color:#FFAB70">start_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2022</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">end_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2023</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">) ) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(seller)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> seller</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_buyer_table</span><span style="color:#E1E4E8">(n_buyer: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer[</span><span style="color:#9ECBFF">"buyer_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{FAKER</span><span style="color:#E1E4E8">.first_name()</span><span style="color:#79B8FF">}</span><span style="color:#79B8FF"> {FAKER</span><span style="color:#E1E4E8">.last_name()</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer[</span><span style="color:#9ECBFF">"email"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name.lower().replace(</span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">@</span><span style="color:#79B8FF">{FAKER</span><span style="color:#E1E4E8">.free_email_domain()</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> buyer[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">]]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer[</span><span style="color:#9ECBFF">"phone_number"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.phone_number() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer[</span><span style="color:#9ECBFF">"created_at"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.date_time_between( </span><span style="color:#FFAB70">start_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2022</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">end_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2023</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">) ) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(buyer)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> buyer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_seller_address_table</span><span style="color:#E1E4E8">(seller: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, city: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, n_seller_address: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address[</span><span style="color:#9ECBFF">"seller_address_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address[</span><span style="color:#9ECBFF">"seller_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(seller[</span><span style="color:#9ECBFF">"seller_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address[</span><span style="color:#9ECBFF">"city_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(city[</span><span style="color:#9ECBFF">"city_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address[</span><span style="color:#9ECBFF">"address"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.address().split(</span><span style="color:#9ECBFF">","</span><span style="color:#E1E4E8">)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    seller_address[</span><span style="color:#9ECBFF">"zip_code"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.postcode() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_seller_address)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(seller_address)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> seller_address</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_buyer_address_table</span><span style="color:#E1E4E8">(buyer: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, city: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, n_buyer_address: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address[</span><span style="color:#9ECBFF">"buyer_address_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address[</span><span style="color:#9ECBFF">"buyer_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(buyer[</span><span style="color:#9ECBFF">"buyer_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address[</span><span style="color:#9ECBFF">"city_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(city[</span><span style="color:#9ECBFF">"city_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address[</span><span style="color:#9ECBFF">"address"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.address().split(</span><span style="color:#9ECBFF">","</span><span style="color:#E1E4E8">)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer_address)]</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_address[</span><span style="color:#9ECBFF">"zip_code"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.postcode() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_buyer_address)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(buyer_address)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> buyer_address</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_ads_table</span><span style="color:#E1E4E8">(product: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, seller: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, n_ads: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    ads </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"ad_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"title"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.text() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"product_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(product[</span><span style="color:#9ECBFF">"product_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"seller_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(seller[</span><span style="color:#9ECBFF">"seller_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"availability"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice([</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"bids_allowed"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice([</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"price"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.random_int(</span><span style="color:#79B8FF">100_000_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">800_000_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10_000_000</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"><span style="color:#E1E4E8">    ads[</span><span style="color:#9ECBFF">"created_at"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.date_time_between( </span><span style="color:#FFAB70">start_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2022</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">end_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2023</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">) ) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_ads)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(ads)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> ads</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_bids_table</span><span style="color:#E1E4E8">(ads: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, buyer: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, n_bids: </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, is_print: </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    bids </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"bid_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [i</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"ad_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(ads[</span><span style="color:#9ECBFF">"ad_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"buyer_id"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [random.choice(buyer[</span><span style="color:#9ECBFF">"buyer_id"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"amount"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.random_int(</span><span style="color:#79B8FF">100_000_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">800_000_000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10_000_000</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"status"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">.join(random.choices([</span><span style="color:#9ECBFF">"Sent"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Cancelled"</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">weights</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0.9</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0.1</span><span style="color:#E1E4E8">))) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"><span style="color:#E1E4E8">    bids[</span><span style="color:#9ECBFF">"created_at"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">FAKER</span><span style="color:#E1E4E8">.date_time_between( </span><span style="color:#FFAB70">start_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2022</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">end_date</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">datetime(</span><span style="color:#79B8FF">2023</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">) ) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(n_bids)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> is_print:</span></span>
<span class="line"><span style="color:#E1E4E8">        show_data(bids)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> bids</span></span>
<span class="line"></span></code></pre>
<h3 id="save_to_csv">save_to_csv</h3>
<p>The <code>save_to_csv</code> module accepts the generated dictionary and saves it to a CSV file using the <code>csv</code> library.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> csv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> save_to_csv</span><span style="color:#E1E4E8">(data: </span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">, nama_file: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">file</span><span style="color:#F97583">=</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">nama_file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.csv"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">mode</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"w"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">newline</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> csv_file:</span></span>
<span class="line"><span style="color:#E1E4E8">        writer </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> csv.writer(csv_file)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        writer.writerow(</span><span style="color:#79B8FF">list</span><span style="color:#E1E4E8">(data.keys()))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        len_data </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">list</span><span style="color:#E1E4E8">(data.items())[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">][</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> num </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(len_data):</span></span>
<span class="line"><span style="color:#E1E4E8">            row </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> key </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> data.keys():</span></span>
<span class="line"><span style="color:#E1E4E8">                row.append(data[key][num])</span></span>
<span class="line"><span style="color:#E1E4E8">            writer.writerow(row)</span></span>
<span class="line"></span></code></pre>
<p>The end result is 8 CSV files which will be imported into the tables in the PostgreSQL database.</p>
<h2 id="database-backup">Database Backup</h2>
<p>After all tables are filled in, a backup is created to facilitate the database restore process in case of unexpected events. The backup data is stored in the <code>backup.sql</code> file.</p>
<h2 id="transactional-query">Transactional Query</h2>
<h3 id="1-looking-for-cars-from-2015-and-newer">1. Looking for cars from 2015 and newer</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">    ad_id,</span></span>
<span class="line"><span style="color:#E1E4E8">    product_id, </span></span>
<span class="line"><span style="color:#E1E4E8">    brand, </span></span>
<span class="line"><span style="color:#E1E4E8">    model, </span></span>
<span class="line"><span style="color:#F97583">    year</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#E1E4E8">    price </span></span>
<span class="line"><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    ads</span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    products</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583"> WHERE</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    year</span><span style="color:#F97583"> >=</span><span style="color:#79B8FF"> 2015</span></span>
<span class="line"><span style="color:#F97583"> ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    year</span><span style="color:#F97583"> ASC</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    ad_id </span><span style="color:#F97583">ASC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output transactional query 1](docs/queries/transactional-query-1.png) -->
<h3 id="2-added-one-new-product-bid-record">2. Added one new product bid record</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">INSERT INTO</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    bids(bid_id, ad_id, buyer_id, amount, </span><span style="color:#F97583">status</span><span style="color:#E1E4E8">, created_at) </span></span>
<span class="line"><span style="color:#F97583">    VALUES</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">21</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">42</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">7</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">185500000</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Sent'</span><span style="color:#E1E4E8">, CURRENT_TIMESTAMP)</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output transactional query 2](docs/queries/transactional-query-2a.png) -->
<!-- ![Output transactional query 2](docs/queries/transactional-query-2b.png) -->
<h3 id="3-view-all-cars-sold-from-a-single-account-sorted-by-most-recent-transactions">3. View all cars sold from a single account, sorted by most recent transactions</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">  product_id, </span></span>
<span class="line"><span style="color:#E1E4E8">  brand, </span></span>
<span class="line"><span style="color:#E1E4E8">  model, </span></span>
<span class="line"><span style="color:#F97583">  year</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#E1E4E8">  price, </span></span>
<span class="line"><span style="color:#E1E4E8">  created_at </span></span>
<span class="line"><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  ads </span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  products</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583"> WHERE</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  seller_id </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 11</span></span>
<span class="line"><span style="color:#F97583"> ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  created_at </span><span style="color:#F97583">DESC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output transactional query 3](docs/queries/transactional-query-3.png) -->
<h3 id="4-search-for-the-cheapest-used-cars-based-on-keywords">4. Search for the cheapest used cars based on keywords</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">  ad_id,</span></span>
<span class="line"><span style="color:#E1E4E8">  product_id,</span></span>
<span class="line"><span style="color:#E1E4E8">  brand, </span></span>
<span class="line"><span style="color:#E1E4E8">  model, </span></span>
<span class="line"><span style="color:#F97583">  year</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#E1E4E8">  price</span></span>
<span class="line"><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  ads </span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  products</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583"> WHERE</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  model ILIKE </span><span style="color:#9ECBFF">'%Yaris%'</span></span>
<span class="line"><span style="color:#F97583"> ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  price </span><span style="color:#F97583">ASC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output transactional query 4](docs/queries/transactional-query-4.png) -->
<h3 id="5-find-the-nearest-used-car-based-on-a-city-id">5. Find the nearest used car based on a city id</h3>
<h4 id="distance-calculations-can-be-calculated-using-the-euclidean-distance-formula-based-on-latitude-and-longitude">Distance calculations can be calculated using the euclidean distance formula based on latitude and longitude</h4>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">    -- a. Membuat fungsi untuk menyimpan formula haversine</span></span>
<span class="line"><span style="color:#F97583">    CREATE</span><span style="color:#F97583"> FUNCTION</span><span style="color:#B392F0"> haversine_distance</span><span style="color:#E1E4E8">(point_a </span><span style="color:#F97583">POINT</span><span style="color:#E1E4E8">, point_b </span><span style="color:#F97583">POINT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    RETURNS</span><span style="color:#F97583"> float</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    LANGUAGE</span><span style="color:#E1E4E8"> plpgsql</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    AS</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    $$</span></span>
<span class="line"><span style="color:#F97583">    DECLARE</span></span>
<span class="line"><span style="color:#E1E4E8">        lon_a </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> radians</span><span style="color:#E1E4E8">(point_a[0]);</span></span>
<span class="line"><span style="color:#E1E4E8">        lat_a </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> radians</span><span style="color:#E1E4E8">(point_a[1]);</span></span>
<span class="line"><span style="color:#E1E4E8">        lon_b </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> radians</span><span style="color:#E1E4E8">(point_b[0]);</span></span>
<span class="line"><span style="color:#E1E4E8">        lat_b </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> radians</span><span style="color:#E1E4E8">(point_b[1]);</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">        d_lon </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> lon_b </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> lon_a;</span></span>
<span class="line"><span style="color:#E1E4E8">        d_lat </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> lat_b </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> lat_a;</span></span>
<span class="line"><span style="color:#E1E4E8">        a </span><span style="color:#F97583">float</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        c </span><span style="color:#F97583">float</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        r </span><span style="color:#F97583">float</span><span style="color:#E1E4E8"> :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 6371</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        jarak </span><span style="color:#F97583">float</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    BEGIN</span></span>
<span class="line"><span style="color:#6A737D">        -- haversine formula</span></span>
<span class="line"><span style="color:#E1E4E8">        a :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sin</span><span style="color:#E1E4E8">(d_lat</span><span style="color:#F97583">/</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)^</span><span style="color:#79B8FF">2</span><span style="color:#F97583"> +</span><span style="color:#79B8FF"> cos</span><span style="color:#E1E4E8">(lat_a) </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> cos</span><span style="color:#E1E4E8">(lat_b) </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> sin</span><span style="color:#E1E4E8">(d_lon</span><span style="color:#F97583">/</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)^</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        c :</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> *</span><span style="color:#79B8FF"> asin</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">sqrt</span><span style="color:#E1E4E8">(a));</span></span>
<span class="line"><span style="color:#E1E4E8">        jarak :</span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> r </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> c;</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#F97583">        RETURN</span><span style="color:#E1E4E8"> jarak;</span></span>
<span class="line"><span style="color:#F97583">    END</span></span>
<span class="line"><span style="color:#E1E4E8">    $$</span></span>
<span class="line"><span style="color:#6A737D">    -- b. Mencari jarak antar dua kota dengan menggunakan formula haversine</span></span>
<span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">    product_id,</span></span>
<span class="line"><span style="color:#E1E4E8">    brand, </span></span>
<span class="line"><span style="color:#E1E4E8">    model, </span></span>
<span class="line"><span style="color:#F97583">    year</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#E1E4E8">    price,</span></span>
<span class="line"><span style="color:#E1E4E8">    haversine_distance(</span><span style="color:#F97583">location</span><span style="color:#E1E4E8">, (</span><span style="color:#F97583">SELECT</span><span style="color:#F97583"> location</span><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> city </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> city_id </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 3173</span><span style="color:#E1E4E8">)) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> distance </span></span>
<span class="line"><span style="color:#F97583">FROM</span></span>
<span class="line"><span style="color:#E1E4E8">  ads</span></span>
<span class="line"><span style="color:#F97583">INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  products</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583">LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  seller_address</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(seller_id)</span></span>
<span class="line"><span style="color:#F97583">LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  city</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(city_id)</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    6</span><span style="color:#F97583"> ASC</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#79B8FF">    1</span><span style="color:#F97583"> ASC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output transactional query 5](docs/queries/transactional-query-5.png) -->
<h2 id="analytical-query">Analytical Query</h2>
<h3 id="1-car-model-popularity-ranking-based-on-bid-amount">1. Car model popularity ranking based on bid amount</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">  model, </span></span>
<span class="line"><span style="color:#79B8FF">  COUNT</span><span style="color:#E1E4E8">(product_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> count_product,</span></span>
<span class="line"><span style="color:#79B8FF">  COUNT</span><span style="color:#E1E4E8">(bid_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> count_bid</span></span>
<span class="line"><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    ads</span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    products</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583"> LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  bids</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(ad_id)</span></span>
<span class="line"><span style="color:#F97583"> GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">  model</span></span>
<span class="line"><span style="color:#F97583"> ORDER BY</span></span>
<span class="line"><span style="color:#E1E4E8">  count_bid </span><span style="color:#F97583">DESC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output analytical query 1](docs/queries/analytical-query-1.png) -->
<h3 id="2-compare-car-prices-based-on-the-average-price-per-city">2. Compare car prices based on the average price per city</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#F97583">  name</span><span style="color:#F97583"> AS</span><span style="color:#E1E4E8"> nama_kota,</span></span>
<span class="line"><span style="color:#E1E4E8">  brand,</span></span>
<span class="line"><span style="color:#E1E4E8">  model,</span></span>
<span class="line"><span style="color:#F97583">  year</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  price,</span></span>
<span class="line"><span style="color:#79B8FF">  AVG</span><span style="color:#E1E4E8">(price) </span><span style="color:#F97583">OVER</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">PARTITION</span><span style="color:#F97583"> BY</span><span style="color:#F97583"> name</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> avg_car_city</span></span>
<span class="line"><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    city</span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  seller_address</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(city_id)</span></span>
<span class="line"><span style="color:#F97583"> INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  ads</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(seller_id)</span></span>
<span class="line"><span style="color:#F97583"> LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">  products</span></span>
<span class="line"><span style="color:#F97583">  USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583"> ORDER BY</span></span>
<span class="line"><span style="color:#79B8FF">    6</span><span style="color:#F97583"> ASC</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#79B8FF">    5</span><span style="color:#F97583"> ASC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output analytical query 2](docs/queries/analytical-query-2.png) -->
<h3 id="3-from-the-car-models-offers-compare-the-date-the-user-made-a-bid-with-the-date-of-the-next-bid-and-the-respective-bid-prices">3. From the car modelâ€™s offers, compare the date the user made a bid with the date of the next bid and the respective bid prices</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    model,</span></span>
<span class="line"><span style="color:#E1E4E8">    buyer_id,</span></span>
<span class="line"><span style="color:#79B8FF">    FIRST_VALUE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">bids</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">created_at</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">OVER</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">PARTITION</span><span style="color:#F97583"> BY</span><span style="color:#E1E4E8"> buyer_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> first_bid_date,</span></span>
<span class="line"><span style="color:#79B8FF">    LEAD</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">bids</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">created_at</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">OVER</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">PARTITION</span><span style="color:#F97583"> BY</span><span style="color:#E1E4E8"> buyer_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> next_bid_date,</span></span>
<span class="line"><span style="color:#79B8FF">    FIRST_VALUE</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">OVER</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">PARTITION</span><span style="color:#F97583"> BY</span><span style="color:#E1E4E8"> buyer_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> first_bid_price,</span></span>
<span class="line"><span style="color:#79B8FF">    LEAD</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">OVER</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">PARTITION</span><span style="color:#F97583"> BY</span><span style="color:#E1E4E8"> buyer_id) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> next_bid_price</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    bids</span></span>
<span class="line"><span style="color:#F97583">INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">    ads</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(ad_id)</span></span>
<span class="line"><span style="color:#F97583">LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">    products</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583">WHERE</span></span>
<span class="line"><span style="color:#E1E4E8">    model </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'Toyota Yaris'</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span></span>
<span class="line"><span style="color:#79B8FF">    3</span><span style="color:#F97583"> ASC</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output analytical query 3](docs/queries/analytical-query-3.png) -->
<h3 id="4-comparing-the-percentage-difference-between-the-average-car-price-by-model-and-the-average-bid-price-offered-by-customers-in-the-last-6-months">4. Comparing the percentage difference between the average car price by model and the average bid price offered by customers in the last 6 months</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">    model,</span></span>
<span class="line"><span style="color:#79B8FF">    AVG</span><span style="color:#E1E4E8">(price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> avg_price,</span></span>
<span class="line"><span style="color:#79B8FF">    AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> avg_bid_6month,</span></span>
<span class="line"><span style="color:#79B8FF">    AVG</span><span style="color:#E1E4E8">(price) </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> difference,</span></span>
<span class="line"><span style="color:#E1E4E8">    ((</span><span style="color:#79B8FF">AVG</span><span style="color:#E1E4E8">(price) </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount)) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(price))::</span><span style="color:#F97583">float</span><span style="color:#F97583"> *</span><span style="color:#79B8FF"> 100</span><span style="color:#F97583"> AS</span><span style="color:#E1E4E8"> difference_percent</span></span>
<span class="line"><span style="color:#F97583">FROM</span></span>
<span class="line"><span style="color:#E1E4E8">    bids</span></span>
<span class="line"><span style="color:#F97583">INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">    ads</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(ad_id)</span></span>
<span class="line"><span style="color:#F97583">LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">    products</span></span>
<span class="line"><span style="color:#F97583">    USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583">WHERE</span></span>
<span class="line"><span style="color:#79B8FF">    bids</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">created_at</span><span style="color:#F97583"> >=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> INTERVAL </span><span style="color:#9ECBFF">'6 months'</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span></span>
<span class="line"><span style="color:#E1E4E8">    model</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output analytical query 4](docs/queries/analytical-query-4.png) -->
<h3 id="5-create-a-window-function-for-the-average-bid-price-of-a-car-brand-and-model-for-the-last-6-months">5. Create a window function for the average bid price of a car brand and model for the last 6 months</h3>
<p>Query:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">WITH</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#F97583">    SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">        brand,</span></span>
<span class="line"><span style="color:#E1E4E8">        model,</span></span>
<span class="line"><span style="color:#79B8FF">        bids</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">created_at</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        amount</span></span>
<span class="line"><span style="color:#F97583">    FROM</span></span>
<span class="line"><span style="color:#E1E4E8">        bids</span></span>
<span class="line"><span style="color:#F97583">    INNER JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">        ads</span></span>
<span class="line"><span style="color:#F97583">        USING</span><span style="color:#E1E4E8">(ad_id)</span></span>
<span class="line"><span style="color:#F97583">    LEFT JOIN</span></span>
<span class="line"><span style="color:#E1E4E8">        products</span></span>
<span class="line"><span style="color:#F97583">        USING</span><span style="color:#E1E4E8">(product_id)</span></span>
<span class="line"><span style="color:#F97583">    WHERE</span></span>
<span class="line"><span style="color:#E1E4E8">        model </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'Toyota Yaris'</span></span>
<span class="line"><span style="color:#E1E4E8"> )</span></span>
<span class="line"><span style="color:#F97583"> SELECT</span></span>
<span class="line"><span style="color:#F97583">  DISTINCT</span><span style="color:#E1E4E8"> brand,</span></span>
<span class="line"><span style="color:#E1E4E8">  model,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'6 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_6,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'5 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_5,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'4 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_4,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'3 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_3,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'2 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_2,</span></span>
<span class="line"><span style="color:#E1E4E8">  (</span><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> AVG</span><span style="color:#E1E4E8">(amount) </span><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> bids_yaris </span><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> created_at </span><span style="color:#F97583">>=</span><span style="color:#E1E4E8"> CURRENT_TIMESTAMP </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> interval </span><span style="color:#9ECBFF">'1 months'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> m_min_1</span></span>
<span class="line"><span style="color:#F97583"> FROM</span></span>
<span class="line"><span style="color:#E1E4E8">  bids_yaris</span></span>
<span class="line"></span></code></pre>
<p>Output:</p>
<!-- ![Output analytical query 5](docs/queries/analytical-query-5.png) -->
<h2 id="conclusion">Conclusion</h2>
<p>That concludes the overview of the process for designing PostgreSQL database. Additionally, it is important to implement a backup and restore mechanism to ensure data integrity in case of any issues or data loss.</p> </article> </main>  <footer class="flex items-center justify-between w-screen px-16 py-4 text-xs border-t border-fuchsia-400 text-fuchsia-400"> <p>&copy; 2024. All rights reserved.</p> <span class="flex items-center gap-2"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"></path></svg> <a href="mailto:mad4869@gmail.com" target="_blank" title="Reach via email" class="hover:underline">mad4869@gmail.com</a> </span> </footer>  </body> </html>